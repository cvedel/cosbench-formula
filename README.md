cosbench-formula
================

Install [COSBench](https://github.com/intel-cloud/cosbench) controllers and drivers on RHEL/CentOS 6 hosts. This formula follows the installation steps described in the [COSBench User Guide](https://github.com/intel-cloud/cosbench/blob/master/COSBenchUserGuide.pdf). 
The drivers make their URL available in the salt mine so that the list of drivers in the controller's configuration file can be built automatically. This requires a [change in the minion configuration](#minion-config).


## Available states

### `cosbench.driver`
-----------------

Installs a cosbench driver. The driver listens on the network interface specified by the `cosbench:interface` pillar value.

### `cosbench.controller`
-----------------

Installs a cosbench controller.

## Pillar Configuration
--------------------

A few parameters can be specified in the pillar:

* **cosbench:identifier**
  The name used when displaying drivers in the controller web UI.

* **cosbench:version**
  The version of COSBench that is installed.

* **cosbench:package**
  The COSBench zip package to install. This parameter is used as the source of a file.managed state so it can be a file within one of your file_roots hierarchy (salt://...) or a ftp or http URL.

* **cosbench:interface**
  The network interface used for controller/drivers communications. It will not be used for the network traffic generated by test workloads and should correspond to the management network if one exists.

The default pillar values are:

``` YAML
cosbench:
  identifier: {{ grains['host'] }}
  version: 0.4.0.a1
  package: https://github.com/intel-cloud/cosbench/releases/download/v0.4.0.a1/0.4.0.a1.zip
  interface: eth0
```

## <a name="minion-config"></a>Salt Minion Configuration

In order to create the driver sections in the controller configuration file automatically, `grains.items` must be added to the mine functions. You need the following lines in the /etc/salt/minion configuration file on the drivers' hosts:

``` YAML
mine_functions:
  grains.items: []
```
